<%= javascript_pack_tag 'hide' %>
<h1>Booking Information</h1>

<div>
  <% flash.each do |type, msg| %>
  <div>
    <%= msg %>
  </div>
  <% end %>
  <%= form_for(@booking) do |f| %>
  <%= f.hidden_field :flight_id, value: params[:flight_id] %>
  <%= f.hidden_field :num_passengers, value: @num_passengers %>
  <%= f.hidden_field :total_price, value: @total_price %>

    Departing from: <%= @flight.departure_airport.name %> |
    Arriving to: <%= @flight.arrival_airport.name %> |
    Date: <%= @flight.departure_time %> |
    Price: <%= @total_price %>
    <%= pluralize(@num_passengers, "passenger") %>

    <ul>
      <%= f.fields_for :passengers do |passenger_form| %>
        <li>
          <%= passenger_form.label :name %>
          <%= passenger_form.text_field :name, required: true %>
          <%= passenger_form.label :email %>
          <%= passenger_form.email_field :email, required: true %>
        </li>
      <% end %>
    </ul>
      <input type="hidden" name="payment_method_token" id="payment_method_token">
      <input type="button" value="Enter Payment Info" onclick="SpreedlyExpress.openView();">
      <input id="retain" name="credit_card[storage_state]" type="checkbox" value="true" />
      <label for="retain">Save card for future use?</label>
    <div>
      <%= submit_tag "Create Booking" %>
    </div>
  <% end %>
</div>

<%= link_to "Back to search", flights_path %>
